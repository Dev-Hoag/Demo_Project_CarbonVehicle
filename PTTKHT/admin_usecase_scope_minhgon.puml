''' Admin_Tong_quan '''
@startuml

skinparam monochrome true
skinparam shadowing false
skinparam defaultFontName Arial
left to right direction

actor "Admin" as ADM <<actor>>
rectangle "«subject» Bảng điều khiển Quản trị" as SYS {
  package "A. Quản lý người dùng" {
    usecase "UC01 Quản lý tài khoản người dùng" as UC01
    usecase "UC02 Quản lý vai trò & quyền (RBAC)" as UC02
    usecase "UC03 Khóa/Mở khóa tài khoản" as UC03
  }
  package "B. Giao dịch" {
    usecase "UC04 Giám sát giao dịch" as UC04
    usecase "UC05 Xử lý giao dịch (Duyệt/Huỷ/Điều chỉnh)" as UC05
    usecase "UC06 Xử lý tranh chấp" as UC06
  }
  package "C. Ví & Dòng tiền" {
    usecase "UC07 Đối soát sổ cái & số dư ví" as UC07
    usecase "UC08 Duyệt chi (Payout)" as UC08
    usecase "UC09 Đóng băng/Giải băng ví" as UC09
  }
  package "D. Niêm yết & Giao dịch" {
    usecase "UC10 Kiểm duyệt niêm yết vi phạm" as UC10
    usecase "UC11 Đóng băng/Huỷ niêm yết" as UC11
    usecase "UC12 Cấu hình tham số đấu giá" as UC12
  }
  package "E. Báo cáo & Cảnh báo" {
    usecase "UC13 Tạo báo cáo tổng hợp" as UC13
    usecase "UC14 Xuất dữ liệu CSV/Excel" as UC14
    usecase "UC15 Thiết lập cảnh báo rủi ro" as UC15
  }
}

ADM --> UC01
ADM --> UC02
ADM --> UC03
ADM --> UC04
ADM --> UC05
ADM --> UC06
ADM --> UC07
ADM --> UC08
ADM --> UC09
ADM --> UC10
ADM --> UC11
ADM --> UC12
ADM --> UC13
ADM --> UC14
ADM --> UC15

' Quan hệ include/extend cốt lõi
UC01 ..> UC02 : <<include>>\n(gán quyền khi tạo)
UC03 ..> UC01 : <<extend>>\n[tài khoản bị gắn cờ]
UC05 ..> UC04 : <<extend>>\n[bất thường]
UC08 ..> UC07 : <<include>>\n(đối soát sau chi)
UC11 ..> UC05 : <<include>>\n(điều chỉnh đơn liên quan)
UC14 ..> UC13 : <<extend>>
UC15 ..> UC04 : <<extend>>\n(trigger)
UC15 ..> UC08 : <<extend>>\n(trigger)
@enduml


''' Admin_Nhom_A_Nguoi_dung '''
@startuml

skinparam monochrome true
skinparam shadowing false
skinparam defaultFontName Arial
left to right direction

actor "Admin" as ADM <<actor>>
rectangle "«subject» A. Quản lý người dùng" as SUBJ {
  usecase "UC01 Quản lý tài khoản người dùng" as UC01
  usecase "UC01.1 Tìm kiếm người dùng" as UC011
  usecase "UC01.2 Xem hồ sơ" as UC012
  usecase "UC01.3 Tạo người dùng" as UC013
  usecase "UC01.4 Cập nhật thông tin" as UC014
  usecase "UC01.5 Vô hiệu hoá/Kích hoạt" as UC015
  usecase "UC01.6 Xác minh KYC" as UC016
  usecase "UC01.7 Đặt lại mật khẩu/MFA" as UC017
  usecase "UC01.8 Ghi nhật ký audit" as UC018

  usecase "UC02 Quản lý vai trò & quyền (RBAC)" as UC02
  usecase "UC02.1 Tạo/Sửa vai trò" as UC021
  usecase "UC02.2 Quản lý quyền" as UC022
  usecase "UC02.3 Gán/Thu hồi vai trò" as UC023

  usecase "UC03 Khóa/Mở khóa tài khoản" as UC03
  usecase "UC03.1 Ghi nhận chế tài" as UC031
  usecase "UC03.2 Thông báo người dùng" as UC032
}

ADM --> UC01
ADM --> UC02
ADM --> UC03

UC01 ..> UC011 : <<include>>
UC01 ..> UC012 : <<include>>
UC01 ..> UC013 : <<include>>
UC01 ..> UC014 : <<include>>
UC01 ..> UC015 : <<include>>
UC01 ..> UC016 : <<include>>
UC01 ..> UC017 : <<include>>
UC01 ..> UC018 : <<include>>
UC02 ..> UC021 : <<include>>
UC02 ..> UC022 : <<include>>
UC02 ..> UC023 : <<include>>
UC03 ..> UC031 : <<include>>
UC03 ..> UC032 : <<include>>
UC03 ..> UC01 : <<extend>>\n[tài khoản bị gắn cờ]
@enduml


''' Admin_Nhom_B_Giao_dich '''
@startuml

skinparam monochrome true
skinparam shadowing false
skinparam defaultFontName Arial
left to right direction

actor "Admin" as ADM <<actor>>
rectangle "«subject» B. Giao dịch & Tranh chấp" as SUBJ {
  usecase "UC04 Giám sát giao dịch" as UC04
  usecase "UC04.1 Lọc thời gian/trạng thái" as UC041
  usecase "UC04.2 Xem chi tiết giao dịch" as UC042
  usecase "UC04.3 Gắn cờ nghi ngờ" as UC043
  usecase "UC04.4 Xuất snapshot" as UC044

  usecase "UC05 Xử lý giao dịch (Duyệt/Huỷ/Điều chỉnh)" as UC05
  usecase "UC05.1 Xem bằng chứng/log" as UC051
  usecase "UC05.2 Duyệt giao dịch" as UC052
  usecase "UC05.3 Huỷ giao dịch" as UC053
  usecase "UC05.4 Điều chỉnh (số lượng/giá)" as UC054
  usecase "UC05.5 Cập nhật sổ cái" as UC055
  usecase "UC05.6 Thông báo các bên" as UC056

  usecase "UC06 Xử lý tranh chấp" as UC06
  usecase "UC06.1 Tạo hồ sơ tranh chấp" as UC061
  usecase "UC06.2 Thu thập bằng chứng" as UC062
  usecase "UC06.3 Ra quyết định" as UC063
  usecase "UC06.4 Thực thi: Hoàn tiền/Điều chỉnh" as UC064
}

ADM --> UC04
ADM --> UC05
ADM --> UC06

UC04 ..> UC041 : <<include>>
UC04 ..> UC042 : <<include>>
UC04 ..> UC043 : <<include>>
UC04 ..> UC044 : <<include>>

UC05 ..> UC051 : <<include>>
UC05 ..> UC052 : <<include>>
UC05 ..> UC053 : <<include>>
UC05 ..> UC054 : <<include>>
UC05 ..> UC055 : <<include>>
UC05 ..> UC056 : <<include>>
UC05 ..> UC04 : <<extend>>\n[bất thường]

UC06 ..> UC061 : <<include>>
UC06 ..> UC062 : <<include>>
UC06 ..> UC063 : <<include>>
UC06 ..> UC064 : <<include>>
UC06 ..> UC055 : <<include>>\n(cập nhật sổ cái)
@enduml


''' Admin_Nhom_C_Vi_Dong_tien '''
@startuml

skinparam monochrome true
skinparam shadowing false
skinparam defaultFontName Arial
left to right direction

actor "Admin" as ADM <<actor>>
rectangle "«subject» C. Ví & Dòng tiền" as SUBJ {
  usecase "UC07 Đối soát sổ cái & số dư ví" as UC07
  usecase "UC07.1 Nhập sao kê từ cổng thanh toán" as UC071
  usecase "UC07.2 So khớp giao dịch (diff)" as UC072
  usecase "UC07.3 Tạo bút toán điều chỉnh" as UC073
  usecase "UC07.4 Khoá kỳ đối soát" as UC074
  usecase "UC07.5 Báo cáo đối soát" as UC075

  usecase "UC08 Duyệt chi (Payout)" as UC08
  usecase "UC08.1 Kiểm tra AML/KYC & hạn mức" as UC081
  usecase "UC08.2 Gửi lệnh chuyển tiền" as UC082
  usecase "UC08.3 Xử lý webhook/trạng thái" as UC083
  usecase "UC08.4 Ghi audit & biên lai" as UC084

  usecase "UC09 Đóng băng/Giải băng ví" as UC09
  usecase "UC09.1 Ghi nhận lý do & TTL" as UC091
  usecase "UC09.2 Thông báo chủ ví" as UC092
}

ADM --> UC07
ADM --> UC08
ADM --> UC09

UC07 ..> UC071 : <<include>>
UC07 ..> UC072 : <<include>>
UC07 ..> UC073 : <<include>>
UC07 ..> UC074 : <<include>>
UC07 ..> UC075 : <<include>>

UC08 ..> UC081 : <<include>>
UC08 ..> UC082 : <<include>>
UC08 ..> UC083 : <<include>>
UC08 ..> UC084 : <<include>>
UC08 ..> UC07 : <<include>>\n(đối soát sau chi)

UC09 ..> UC091 : <<include>>
UC09 ..> UC092 : <<include>>
UC09 ..> UC08 : <<extend>>\n[nghi ngờ payout]
@enduml


''' Admin_Nhom_D_Niem_yet '''
@startuml

skinparam monochrome true
skinparam shadowing false
skinparam defaultFontName Arial
left to right direction

actor "Admin" as ADM <<actor>>
rectangle "«subject» D. Niêm yết & Giao dịch" as SUBJ {
  usecase "UC10 Kiểm duyệt niêm yết vi phạm" as UC10
  usecase "UC10.1 Lọc niêm yết bị gắn cờ" as UC101
  usecase "UC10.2 Xem lịch sử & bằng chứng" as UC102
  usecase "UC10.3 Ẩn/Khôi phục niêm yết" as UC103
  usecase "UC10.4 Thông báo người bán" as UC104

  usecase "UC11 Đóng băng/Huỷ niêm yết" as UC11
  usecase "UC11.1 Khoá khẩn niêm yết" as UC111
  usecase "UC11.2 Rollback đơn liên quan" as UC112
  usecase "UC11.3 Hoàn tiền nếu đã thanh toán" as UC113
  usecase "UC11.4 Ghi audit" as UC114

  usecase "UC12 Cấu hình tham số đấu giá" as UC12
  usecase "UC12.1 Bước giá" as UC121
  usecase "UC12.2 Khung giờ & thời lượng" as UC122
  usecase "UC12.3 Anti-sniping" as UC123
  usecase "UC12.4 Áp dụng theo danh mục/nhóm" as UC124
}

ADM --> UC10
ADM --> UC11
ADM --> UC12

UC10 ..> UC101 : <<include>>
UC10 ..> UC102 : <<include>>
UC10 ..> UC103 : <<include>>
UC10 ..> UC104 : <<include>>

UC11 ..> UC111 : <<include>>
UC11 ..> UC112 : <<include>>
UC11 ..> UC113 : <<include>>
UC11 ..> UC114 : <<include>>
UC11 ..> UC05 : <<include>>\n(điều chỉnh đơn liên quan)

UC12 ..> UC121 : <<include>>
UC12 ..> UC122 : <<include>>
UC12 ..> UC123 : <<include>>
UC12 ..> UC124 : <<include>>
@enduml


''' Admin_Nhom_E_Bao_cao_Canh_bao '''
@startuml

skinparam monochrome true
skinparam shadowing false
skinparam defaultFontName Arial
left to right direction

actor "Admin" as ADM <<actor>>
rectangle "«subject» E. Báo cáo & Cảnh báo" as SUBJ {
  usecase "UC13 Tạo báo cáo tổng hợp" as UC13
  usecase "UC13.1 Chọn kỳ & chỉ số" as UC131
  usecase "UC13.2 Chạy tổng hợp (async)" as UC132
  usecase "UC13.3 Lưu mẫu (template)" as UC133
  usecase "UC13.4 Lịch chạy định kỳ" as UC134

  usecase "UC14 Xuất dữ liệu CSV/Excel" as UC14
  usecase "UC14.1 Chọn trường & định dạng" as UC141
  usecase "UC14.2 Ẩn dữ liệu nhạy cảm theo vai trò" as UC142
  usecase "UC14.3 Ký số tệp xuất" as UC143

  usecase "UC15 Thiết lập cảnh báo rủi ro" as UC15
  usecase "UC15.1 Định nghĩa ngưỡng/quy tắc" as UC151
  usecase "UC15.2 Kiểm thử quy tắc" as UC152
  usecase "UC15.3 Triển khai & theo dõi" as UC153
}

ADM --> UC13
ADM --> UC14
ADM --> UC15

UC13 ..> UC131 : <<include>>
UC13 ..> UC132 : <<include>>
UC13 ..> UC133 : <<include>>
UC13 ..> UC134 : <<include>>

UC14 ..> UC141 : <<include>>
UC14 ..> UC142 : <<include>>
UC14 ..> UC143 : <<include>>
UC14 ..> UC13 : <<extend>>

UC15 ..> UC151 : <<include>>
UC15 ..> UC152 : <<include>>
UC15 ..> UC153 : <<include>>
UC15 ..> UC04 : <<extend>>\n(kích hoạt khi bất thường)
UC15 ..> UC08 : <<extend>>\n(kích hoạt AML/hạn mức)
@enduml
